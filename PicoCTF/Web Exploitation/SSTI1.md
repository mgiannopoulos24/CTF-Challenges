### Challenge: SSTI 1
### Difficulty: Easy
#### Prepared by: jnzachos

&nbsp;

The author provides a link to a webpage.

After visiting it, we see this:

<img width="1919" height="912" alt="image" src="https://github.com/user-attachments/assets/c52f1e3e-1f8e-4f25-8f38-9c9cf479f091" />

&nbsp;

When we enter our text and click "Ok", it is printed on the page.

<img width="1919" height="908" alt="image" src="https://github.com/user-attachments/assets/b2c7a8c9-2e60-4ad0-b58d-db899b901a15" />

&nbsp;

<img width="1915" height="958" alt="image" src="https://github.com/user-attachments/assets/76984127-6004-4df4-89ca-7b9dc47a6246" />

&nbsp;

Since this is a "Server Side Template Injection" ([SSTI](https://www.geeksforgeeks.org/computer-networks/what-is-server-side-template-injection/)) challenge, we inject the payload ```{{7*7}}``` to check. 

<img width="1915" height="920" alt="image" src="https://github.com/user-attachments/assets/f4a35ce2-b79b-41ae-9ec1-00c8b04ed0f1" />

&nbsp;

<img width="1918" height="921" alt="image" src="https://github.com/user-attachments/assets/3984d79c-3bf9-49c9-a7c8-f4364adf130a" />

&nbsp;

So as we can see the `/announce` endpoint literally echoed ```49```. This means we can execute code.

&nbsp;

Next, we inject the payload ```{{7*'7'}}``` in order to discover the templating engine.

<img width="1914" height="946" alt="image" src="https://github.com/user-attachments/assets/9e432502-1fbb-47dc-8157-7cc155e8094f" />

&nbsp;

<img width="1916" height="938" alt="image" src="https://github.com/user-attachments/assets/2f594eb1-5aab-46e1-965f-294d0356dd9d" />


&nbsp;

The endpoint returns ```7777777```, which confirms the use of jinja and python. ([What is jinja?](https://jinja.palletsprojects.com/en/stable/))

&nbsp;

Our next step is to find a way to run the ```ls``` command, but using python. ([More info](https://www.geeksforgeeks.org/python/how-use-linux-command-in-python-using-system-os/))

By injecting the payload ```{{self.__init__.__globals__.__builtins__.__import__('os').popen('ls').read()}}``` we get our output:

<img width="1916" height="940" alt="image" src="https://github.com/user-attachments/assets/09675efe-d233-42ef-8c1b-442a05a9343b" />

&nbsp;

<img width="1917" height="940" alt="image" src="https://github.com/user-attachments/assets/306e6d29-c194-4215-b63d-7fb0fc8b718d" />


&nbsp;

Our final step, is to run the ```cat``` command for the file we want (in this case for "flag"), again, using python.

Our payload will now be ```{{self.__init__.__globals__.__builtins__.__import__('os').popen('cat flag').read()}}```

<img width="1913" height="942" alt="image" src="https://github.com/user-attachments/assets/98e0791d-40f0-4599-a597-c2f2a5416397" />

&nbsp;

When we click "Ok", the flag should be printed and we will have solved the challenge!

<img width="1907" height="932" alt="image" src="https://github.com/user-attachments/assets/f7d91955-9206-420f-a2f2-f2303b8b6555" />

